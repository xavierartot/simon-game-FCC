'use strict';

//https://toddmotto.com/mastering-the-module-pattern/#revealing-module-pattern
var Simon = function () {
  var data = {
    caseCoche: document.querySelector('.caseCoche'),
    start: document.querySelector('.text__start'),
    startActive: document.querySelector('.text__btn'), //start btn
    green: document.querySelector('.shape__color-green'),
    red: document.querySelector('.shape__color-red'),
    blue: document.querySelector('.shape__color-blue'),
    yellow: document.querySelector('.shape__color-yellow'),
    countBox: document.querySelector('.text__box'), //count
    arraySimon: []
  },
      dataGame = {
    1: { color: 'green', num: 1, sound: 'http://artot.net/sounds/other1.mp3' },
    2: { color: 'red', num: 2, sound: 'http://artot.net/sounds/other2.mp3' },
    3: { color: 'blue', num: 3, sound: 'http://artot.net/sounds/play.mp3' },
    4: { color: 'yellow', num: 4, sound: 'http://artot.net/sounds/soft.mp3' }
  },
      errorSound = 'https://s3.amazonaws.com/freecodecamp/simonSound1.mp3',
      //from https://www.freecodecamp.com/challenges/build-a-simon-game
  color = '',
      random = '',
      randomTemp = '';

  // private
  var _playSound = function _playSound(sound) {
    new Audio(sound).play();
  };

  // the ai start
  var _turn = function _turn(t) {
    if (data.caseCoche.checked !== false) {
      alert('turn on the game');
      return false;
    }
    return t % 2 === 0 ? console.log(1) : console.log(0);
  };

  var error = function error() {
    _playSound(errorSound);
    data.countBox.textContent = 'err';
    data.countBox.classList.add('error');
    return setTimeout(function () {
      _ai();
    }, 1000); //1s
  };

  var opponent = function opponent() {
    data.arraySimon.push(dataGame[randomTemp]);
    for (var i = 0, l = data.arraySimon.length; i < l; i++) {
      var cur = data.arraySimon[i],
          prev = data.arraySimon[i - 1];
      console.log(cur);
    }
  };
  //recursive
  //console.log(dataGame[Random()].color);
  //console.log(dataGame[Random()].num);
  //console.log(dataGame[Random()].sound);
  var _ai = function _ai() {
    if (data.arraySimon.length === 0) {
      randomTemp = Random();
      setTimeout(function () {
        data.arraySimon.push(dataGame[randomTemp]);
        //add la couleur
        for (var prop in data) {
          if (data.hasOwnProperty(prop)) {
            var d = data[prop];
            if (prop === dataGame[randomTemp].color) {
              d.classList.add('active');
            }
          }
        }
        _playSound(dataGame[randomTemp].sound);
      }, 1000); //1s
      setTimeout(function () {
        error();
      }, 4000);
      return opponent();
    } else if (data.arraySimon.length >= 1) {
      alert(1);
    }
  };

  //random between 1 and 4
  var Random = function Random() {
    random = Math.floor(Math.random() * 4) + 1;
    return random;
  };

  var removeActiveClass = function removeActiveClass() {
    var col = document.querySelectorAll('.shape__color');
    for (var i = 0; i < col.length; i++) {
      col[i].classList.remove('active');
    }
  };

  // private
  // dataGame = sound, num, color
  var _start = function _start() {
    data.caseCoche.checked = false;
    //checked
    data.caseCoche.addEventListener('change', function () {
      //console.log(this.checked);
      if (this.checked) {
        //if this.checked is true
        return true;
      } else {
        data.arraySimon = [];
        //start btn
        data.startActive.classList.remove('active');

        //remove classe active
        removeActiveClass();

        return true;
      }
    });
    data.start.addEventListener('click', function (e) {
      if (data.caseCoche.checked === true) {
        _ai();
        //start btn
        data.startActive.classList.add('active');
      } //end checked true
      e.preventDefault();
    }); // end click on start
    return false;
  };

  //main
  var main = function main() {
    _start();
    return true;
  };

  return {
    main: main
  };
}();
Simon.main();
//Simon.anotherMethod ()
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNjcmlwdC5qcyJdLCJuYW1lcyI6WyJTaW1vbiIsImRhdGEiLCJjYXNlQ29jaGUiLCJkb2N1bWVudCIsInF1ZXJ5U2VsZWN0b3IiLCJzdGFydCIsInN0YXJ0QWN0aXZlIiwiZ3JlZW4iLCJyZWQiLCJibHVlIiwieWVsbG93IiwiY291bnRCb3giLCJhcnJheVNpbW9uIiwiZGF0YUdhbWUiLCJjb2xvciIsIm51bSIsInNvdW5kIiwiZXJyb3JTb3VuZCIsInJhbmRvbSIsInJhbmRvbVRlbXAiLCJfcGxheVNvdW5kIiwiQXVkaW8iLCJwbGF5IiwiX3R1cm4iLCJ0IiwiY2hlY2tlZCIsImFsZXJ0IiwiY29uc29sZSIsImxvZyIsImVycm9yIiwidGV4dENvbnRlbnQiLCJjbGFzc0xpc3QiLCJhZGQiLCJzZXRUaW1lb3V0IiwiX2FpIiwib3Bwb25lbnQiLCJwdXNoIiwiaSIsImwiLCJsZW5ndGgiLCJjdXIiLCJwcmV2IiwiUmFuZG9tIiwicHJvcCIsImhhc093blByb3BlcnR5IiwiZCIsIk1hdGgiLCJmbG9vciIsInJlbW92ZUFjdGl2ZUNsYXNzIiwiY29sIiwicXVlcnlTZWxlY3RvckFsbCIsInJlbW92ZSIsIl9zdGFydCIsImFkZEV2ZW50TGlzdGVuZXIiLCJlIiwicHJldmVudERlZmF1bHQiLCJtYWluIl0sIm1hcHBpbmdzIjoiOztBQUFBO0FBQ0EsSUFBSUEsUUFBVSxZQUFNO0FBQ2xCLE1BQUlDLE9BQU87QUFDVEMsZUFBcUJDLFNBQVNDLGFBQVQsQ0FBdUIsWUFBdkIsQ0FEWjtBQUVUQyxXQUFxQkYsU0FBU0MsYUFBVCxDQUF1QixjQUF2QixDQUZaO0FBR1RFLGlCQUFxQkgsU0FBU0MsYUFBVCxDQUF1QixZQUF2QixDQUhaLEVBR2tEO0FBQzNERyxXQUFxQkosU0FBU0MsYUFBVCxDQUF1QixxQkFBdkIsQ0FKWjtBQUtUSSxTQUFxQkwsU0FBU0MsYUFBVCxDQUF1QixtQkFBdkIsQ0FMWjtBQU1USyxVQUFxQk4sU0FBU0MsYUFBVCxDQUF1QixvQkFBdkIsQ0FO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QUNBO0FBQ0FYLGFBQUtLLFdBQUwsQ0FBaUJ5QixTQUFqQixDQUEyQm9CLE1BQTNCLENBQWtDLFFBQWxDOztBQUVBO0FBQ0FIOztBQUVBLGVBQU8sSUFBUDtBQUNEO0FBRUYsS0FmRDtBQWdCQS9DLFNBQUtJLEtBQUwsQ0FBV2dELGdCQUFYLENBQTRCLE9BQTVCLEVBQXFDLFVBQVNDLENBQVQsRUFBWTtBQUMvQyxVQUFJckQsS0FBS0MsU0FBTCxDQUFldUIsT0FBZixLQUEyQixJQUEvQixFQUFxQztBQUNuQ1M7QUFDQTtBQUNBakMsYUFBS0ssV0FBTCxDQUFpQnlCLFNBQWpCLENBQTJCQyxHQUEzQixDQUErQixRQUEvQjtBQUNELE9BTDhDLENBSzdDO0FBQ0ZzQixRQUFFQyxjQUFGO0FBQ0QsS0FQRCxFQW5CaUIsQ0EwQmI7QUFDSixXQUFPLEtBQVA7QUFDRCxHQTVCRDs7QUE4QkE7QUFDQSxNQUFJQyxPQUFRLFNBQVJBLElBQVEsR0FBTTtBQUNoQko7QUFDQSxXQUFPLElBQVA7QUFDRCxHQUhEOztBQUtBLFNBQU87QUFDTEksVUFBT0E7QUFERixHQUFQO0FBSUQsQ0E1SVcsRUFBWjtBQTZJQXhELE1BQU13RCxJQUFOO0FBQ0EiLCJmaWxlIjoic2NyaXB0LmpzIiwic291cmNlc0NvbnRlbnQiOlsiLy9odHRwczovL3RvZGRtb3R0by5jb20vbWFzdGVyaW5nLXRoZS1tb2R1bGUtcGF0dGVybi8jcmV2ZWFsaW5nLW1vZHVsZS1wYXR0ZXJuXG5sZXQgU2ltb24gPSAoICgpID0+IHtcbiAgbGV0IGRhdGEgPSB7IFxuICAgIGNhc2VDb2NoZSAgICAgICAgICA6IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5jYXNlQ29jaGUnKSxcbiAgICBzdGFydCAgICAgICAgICAgICAgOiBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcudGV4dF9fc3RhcnQnKSxcbiAgICBzdGFydEFjdGl2ZSAgICAgICAgOiBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcudGV4dF9fYnRuJyksIC8vc3RhcnQgYnRuXG4gICAgZ3JlZW4gICAgICAgICAgICAgIDogZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnNoYXBlX19jb2xvci1ncmVlbicpLFxuICAgIHJlZCAgICAgICAgICAgICAgICA6IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5zaGFwZV9fY29sb3ItcmVkJyksXG4gICAgYmx1ZSAgICAgICAgICAgICAgIDogZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnNoYXBlX19jb2xvci1ibHVlJyksXG4gICAgeWVsbG93ICAgICAgICAgICAgIDogZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnNoYXBlX19jb2xvci15ZWxsb3cnKSxcbiAgICBjb3VudEJveCAgICAgICAgICAgOiBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcudGV4dF9fYm94JyksLy9jb3VudFxuICAgIGFycmF5U2ltb24gICAgICAgICA6IFtdXG4gIH0sXG5cbiAgZGF0YUdhbWUgPSB7XG4gICAgMSA6IHtjb2xvciA6J2dyZWVuJyAgLCBudW0gOiAgMSwgc291bmQ6ICAnaHR0cDovL2FydG90Lm5ldC9zb3VuZHMvb3RoZXIxLm1wMycgICAgICAgICAgICAgfSxcbiAgICAyIDoge2NvbG9yIDoncmVkJyAgICAsIG51bSA6ICAyLCBzb3VuZDogICdodHRwOi8vYXJ0b3QubmV0L3NvdW5kcy9vdGhlcjIubXAzJyAgICAgICAgICAgICB9LFxuICAgIDMgOiB7Y29sb3IgOidibHVlJyAgICwgbnVtIDogIDMsIHNvdW5kOiAgJ2h0dHA6Ly9hcnRvdC5uZXQvc291bmRzL3BsYXkubXAzJyAgICAgICAgICAgICAgfSxcbiAgICA0IDoge2NvbG9yIDoneWVsbG93JyAsIG51bSA6ICA0LCBzb3VuZDogICdodHRwOi8vYXJ0b3QubmV0L3NvdW5kcy9zb2Z0Lm1wMyd9XG4gIH0sXG4gIGVycm9yU291bmQgPSAnaHR0cHM6Ly9zMy5hbWF6b25hd3MuY29tL2ZyZWVjb2RlY2FtcC9zaW1vblNvdW5kMS5tcDMnLCAvL2Zyb20gaHR0cHM6Ly93d3cuZnJlZWNvZGVjYW1wLmNvbS9jaGFsbGVuZ2VzL2J1aWxkLWEtc2ltb24tZ2FtZVxuICBjb2xvciAgICAgICA9ICcnLFxuICByYW5kb20gICAgICA9ICcnLFxuICByYW5kb21UZW1wICA9ICcnXG5cbiAgLy8gcHJpdmF0ZVxuICBsZXQgX3BsYXlTb3VuZCA9IChzb3VuZCkgPT4ge1xuICAgIG5ldyBBdWRpbyhzb3VuZCkucGxheSgpXG4gIH1cblxuICAvLyB0aGUgYWkgc3RhcnRcbiAgbGV0IF90dXJuID0gKHQpID0+IHtcbiAgICBpZiAoZGF0YS5jYXNlQ29jaGUuY2hlY2tlZCAhPT0gZmFsc2UpIHtcbiAgICAgIGFsZXJ0KCd0dXJuIG9uIHRoZSBnYW1lJylcbiAgICAgIHJldHVybiBmYWxzZVxuICAgIH1cbiAgICByZXR1cm4gdCAlIDIgPT09IDAgPyBjb25zb2xlLmxvZygxKSA6IGNvbnNvbGUubG9nKDApXG4gIH1cblxuICBsZXQgZXJyb3IgPSAoKSA9PiB7XG4gICAgX3BsYXlTb3VuZChlcnJvclNvdW5kIClcbiAgICBkYXRhLmNvdW50Qm94LnRleHRDb250ZW50ID0gJ2VycidcbiAgICBkYXRhLmNvdW50Qm94LmNsYXNzTGlzdC5hZGQoJ2Vycm9yJylcbiAgICByZXR1cm4gc2V0VGltZW91dChmdW5jdGlvbiAoKSB7XG4gICAgICBfYWkoKVxuICAgIH0sIDEwMDApOy8vMXNcbiAgfVxuXG4gIGxldCBvcHBvbmVudCA9ICgpID0+IHtcbiAgICBkYXRhLmFycmF5U2ltb24ucHVzaCggZGF0YUdhbWVbcmFuZG9tVGVtcF0gKVxuICAgIGZvciAobGV0IGkgPSAwLCBsID0gZGF0YS5hcnJheVNpbW9uLmxlbmd0aDsgaSA8IGw7IGkrKykge1xuICAgICAgbGV0IGN1cj0gZGF0YS5hcnJheVNpbW9uW2ldLCBwcmV2ID0gZGF0YS5hcnJheVNpbW9uW2ktMV07XG4gICAgICBjb25zb2xlLmxvZyhjdXIpO1xuICAgIH1cblxuXG4gIH1cbiAgLy9yZWN1cnNpdmVcbiAgLy9jb25zb2xlLmxvZyhkYXRhR2FtZVtSYW5kb20oKV0uY29sb3IpO1xuICAvL2NvbnNvbGUubG9nKGRhdGFHYW1lW1JhbmRvbSgpXS5udW0pO1xuICAvL2NvbnNvbGUubG9nKGRhdGFHYW1lW1JhbmRvbSgpXS5zb3VuZCk7XG4gIGxldCBfYWkgPSAoKSA9PiB7XG4gICAgaWYgKGRhdGEuYXJyYXlTaW1vbi5sZW5ndGggPT09IDApIHtcbiAgICAgIHJhbmRvbVRlbXAgPSBSYW5kb20oKVxuICAgICAgc2V0VGltZW91dChmdW5jdGlvbiAoKSB7XG4gICAgICAgIGRhdGEuYXJyYXlTaW1vbi5wdXNoKCBkYXRhR2FtZVtyYW5kb21UZW1wXSApXG4gICAgICAgIC8vYWRkIGxhIGNvdWxldXJcbiAgICAgICAgZm9yIChsZXQgcHJvcCBpbiBkYXRhKXtcbiAgICAgICAgICBpZiAoZGF0YS5oYXNPd25Qcm9wZXJ0eShwcm9wKSkge1xuICAgICAgICAgICAgbGV0IGQgPWRhdGFbcHJvcF0gXG4gICAgICAgICAgICBpZiAocHJvcCA9PT0gZGF0YUdhbWVbcmFuZG9tVGVtcF0uY29sb3IpIHtcbiAgICAgICAgICAgICAgZC5jbGFzc0xpc3QuYWRkKCdhY3RpdmUnKVxuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBfcGxheVNvdW5kKGRhdGFHYW1lW3JhbmRvbVRlbXBdLnNvdW5kKVxuICAgICAgfSwgMTAwMCk7Ly8xc1xuICAgICAgc2V0VGltZW91dChmdW5jdGlvbiAoKSB7XG4gICAgICAgIGVycm9yKClcbiAgICAgIH0sIDQwMDApO1xuICAgICAgcmV0dXJuIG9wcG9uZW50KClcbiAgICB9IGVsc2UgaWYoZGF0YS5hcnJheVNpbW9uLmxlbmd0aCA+PSAxKXtcbiAgICAgIGFsZXJ0KDEpXG4gICAgfVxuICB9XG5cbiAgLy9yYW5kb20gYmV0d2VlbiAxIGFuZCA0XG4gIGxldCBSYW5kb20gPSAoKSA9PiB7XG4gICAgcmFuZG9tID0gIE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIDQpICsgMSAgXG4gICAgcmV0dXJuIHJhbmRvbSBcbiAgfVxuXG4gIGxldCByZW1vdmVBY3RpdmVDbGFzcyA9ICgpID0+IHtcbiAgICBsZXQgY29sID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLnNoYXBlX19jb2xvcicpXG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCBjb2wubGVuZ3RoOyBpKyspIHtcbiAgICAgIGNvbFtpXS5jbGFzc0xpc3QucmVtb3ZlKCdhY3RpdmUnKVxuICAgIH1cbiAgfVxuXG4gIC8vIHByaXZhdGVcbiAgLy8gZGF0YUdhbWUgPSBzb3VuZCwgbnVtLCBjb2xvclxuICBsZXQgX3N0YXJ0ID0gKCkgPT4ge1xuICAgIGRhdGEuY2FzZUNvY2hlLmNoZWNrZWQgPSBmYWxzZVxuICAgIC8vY2hlY2tlZFxuICAgIGRhdGEuY2FzZUNvY2hlLmFkZEV2ZW50TGlzdGVuZXIoJ2NoYW5nZScsZnVuY3Rpb24oKSB7XG4gICAgICAvL2NvbnNvbGUubG9nKHRoaXMuY2hlY2tlZCk7XG4gICAgICBpZiAodGhpcy5jaGVja2VkKSB7Ly9pZiB0aGlzLmNoZWNrZWQgaXMgdHJ1ZVxuICAgICAgICByZXR1cm4gdHJ1ZVxuICAgICAgfSBlbHNle1xuICAgICAgICBkYXRhLmFycmF5U2ltb24gPSBbXVxuICAgICAgICAvL3N0YXJ0IGJ0blxuICAgICAgICBkYXRhLnN0YXJ0QWN0aXZlLmNsYXNzTGlzdC5yZW1vdmUoJ2FjdGl2ZScpXG5cbiAgICAgICAgLy9yZW1vdmUgY2xhc3NlIGFjdGl2ZVxuICAgICAgICByZW1vdmVBY3RpdmVDbGFzcygpXG5cbiAgICAgICAgcmV0dXJuIHRydWVcbiAgICAgIH0gXG5cbiAgICB9KTtcbiAgICBkYXRhLnN0YXJ0LmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgZnVuY3Rpb24oZSkge1xuICAgICAgaWYgKGRhdGEuY2FzZUNvY2hlLmNoZWNrZWQgPT09IHRydWUpIHtcbiAgICAgICAgX2FpKClcbiAgICAgICAgLy9zdGFydCBidG5cbiAgICAgICAgZGF0YS5zdGFydEFjdGl2ZS5jbGFzc0xpc3QuYWRkKCdhY3RpdmUnKVxuICAgICAgfSAvL2VuZCBjaGVja2VkIHRydWVcbiAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICB9KTsgLy8gZW5kIGNsaWNrIG9uIHN0YXJ0XG4gICAgcmV0dXJuIGZhbHNlXG4gIH1cblxuICAvL21haW5cbiAgbGV0IG1haW4gID0gKCkgPT4ge1xuICAgIF9zdGFydCgpXG4gICAgcmV0dXJuIHRydWVcbiAgfTtcblxuICByZXR1cm4ge1xuICAgIG1haW4gOiBtYWluXG4gIH07XG5cbn0pKCk7XG5TaW1vbi5tYWluKClcbi8vU2ltb24uYW5vdGhlck1ldGhvZCAoKVxuIl19
